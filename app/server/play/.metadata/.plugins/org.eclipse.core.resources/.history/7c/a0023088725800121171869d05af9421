package controllers;

import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

import org.codehaus.jackson.node.ArrayNode;
import org.codehaus.jackson.node.JsonNodeFactory;
import org.codehaus.jackson.node.ObjectNode;

import play.db.DB;

import play.libs.Json;
import play.mvc.BodyParser;
import play.mvc.Controller;
import play.mvc.Result;

public class Logbooks extends Controller {
	
	@BodyParser.Of(BodyParser.Json.class)
	public static Result get() {
		ArrayNode tJsonResult = JsonNodeFactory.instance.arrayNode();
		
		String Query = "SELECT * FROM logbook";
		
		try {
			Connection connection = DB.getConnection();
			Statement select = connection.createStatement();
			ResultSet result = select.executeQuery(Query);

			while (result.next()) {
				ObjectNode tJsonLogBook = Json.newObject();
				tJsonLogBook.put("shipname", result.getString("shipname"));
				tJsonLogBook.put("", result.getString(""));
				tJsonLogBook.put("", result.getString(""));
				tJsonLogBook.put("", result.getString(""));
				tJsonLogBook.put("", result.getString(""));
				tJsonLogBook.put("", result.getString(""));
				tJsonLogBook.put("", result.getString(""));
				tJsonLogBook.put("", result.getString(""));
				tJsonLogBook.put("", result.getString(""));
				tJsonLogBook.put("", result.getString(""));
				tJsonLogBook.put("", result.getString(""));
				tJsonLogBook.put("", result.getString(""));
				tJsonLogBook.put("", result.getString(""));
				tJsonLogBook.put("", result.getString(""));
				tJsonLogBook.put("", result.getString(""));
				tJsonLogBook.put("", result.getString(""));
				tJsonLogBook.put("", result.getString(""));
				tJsonLogBook.put("", result.getString(""));
				tJsonLogBook.put("", result.getString(""));
				tJsonLogBook.put("", result.getString(""));
				tJsonLogBook.put("", result.getString(""));
				tJsonLogBook.put("", result.getString(""));
				tJsonLogBook.put("", result.getString(""));
				tJsonLogBook.put("", result.getString(""));
				tJsonLogBook.put("", result.getString(""));
				
				'shipname' => $row['shipname'],
						'shiptype' => $row['type'],
						'shipowner' => $row['owner'],
						'shipregisternumber' => $row['registnumber'],
						'sailsign' => $row['sailsign'],
						'homeport' => $row['homeport'],
						'yachtclub' => $row['yachtclub'],
						'insurance' => $row['insurance'],
						'callsign' => $row['callsign'],
						'constructer' => $row['constructer'],
						'shiplength' => $row['length'],
						'engine' => $row['engine'],
						'shipwidth' => $row['width'],
						'gauge' => $row['gauge'],
						'mastheight' => $row['mastheight'],
						'expulsion' => $row['expulsion'],
						'rigtype' => $row['rigtype'],
						'constructionyear' => $row['constructionyear'],
						'size_fueltank' => $row['size_fueltank'],
						'size_watertank' => $row['size_watertank'],
						'size_sewagetank' => $row['size_sewagetank'],
						'size_mainsail' => $row['size_mainsail'],
						'size_genua' => $row['size_genua'],
						'size_spi' => $row['size_spi'],
						'dataId' => $row['logbookID']		
				tJsonResult.add(tJsonLogBook);
			}
			connection.close();
			return ok(tJsonResult);
		} catch (SQLException e) {
			e.printStackTrace();
			return badRequest(e.getMessage());
		}
		
	}

}
